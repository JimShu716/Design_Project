<type 'type'>
{
  "grad_clip": 2, 
  "word_dim": 500, 
  "text_mapping_layers": "0-2048", 
  "num_epochs": 50, 
  "logtimestamp": "04160221PM_temp_temp1_logntonp", 
  "text_kernel_sizes": "2-3-4", 
  "measure": "exp", 
  "lr_decay_rate": 0.99, 
  "n_caption": 1, 
  "overwrite": 1, 
  "temperature": 0.6, 
  "workers": 4, 
  "text_norm": true, 
  "neg_sampling": "default", 
  "log_step": 10, 
  "visual_norm": true, 
  "max_violation": true, 
  "visual_feature": "resnet-152-img1k-flatten0_outputos", 
  "trainCollection": "msrvtt_train", 
  "learning_rate": 0.0001, 
  "batch_padding": 0, 
  "direction": "all", 
  "optimizer": "adam", 
  "resume": null, 
  "dropout": 0.2, 
  "visual_kernel_num": 512, 
  "rootpath": "../VisualSearch", 
  "batch_size": 128, 
  "cv_name": "cvpr_2019", 
  "text_kernel_num": 512, 
  "testCollection": "msrvtt_test", 
  "visual_mapping_layers": "0-2048", 
  "cost_style": "sum", 
  "text_rnn_size": 512, 
  "vocab": "word_vocab_5", 
  "loss_fun": "cont", 
  "visual_rnn_size": 1024, 
  "visual_kernel_sizes": "2-3-4-5", 
  "concate": "full", 
  "postfix": "runs_0", 
  "val_metric": "recall", 
  "valCollection": "msrvtt_eval", 
  "model": "dual_encoding", 
  "margin": 0.2
}
../VisualSearch/msrvtt_train/cvpr_2019/msrvtt_eval/dual_encoding_concate_full_dp_0.2_measure_exp/vocab_word_vocab_5_word_dim_500_text_rnn_size_512_text_norm_True_kernel_sizes_2-3-4_num_512/visual_feature_resnet-152-img1k-flatten0_outputos_visual_rnn_size_1024_visual_norm_True_kernel_sizes_2-3-4-5_num_512/mapping_text_0-2048_img_0-2048/loss_func_cont_margin_0.2_direction_all_max_violation_True_cost_style_sum/optimizer_adam_lr_0.0001_decay_0.99_grad_clip_2.0_val_metric_recall/runs_0
../VisualSearch/msrvtt_train/cvpr_2019/msrvtt_eval/dual_encoding_concate_full_dp_0.2_measure_exp/vocab_word_vocab_5_word_dim_500_text_rnn_size_512_text_norm_True_kernel_sizes_2-3-4_num_512/visual_feature_resnet-152-img1k-flatten0_outputos_visual_rnn_size_1024_visual_norm_True_kernel_sizes_2-3-4-5_num_512/mapping_text_0-2048_img_0-2048/loss_func_cont_margin_0.2_direction_all_max_violation_True_cost_style_sum/optimizer_adam_lr_0.0001_decay_0.99_grad_clip_2.0_val_metric_recall/runs_0/model_best.pth.tar exists.
overwrite
../VisualSearch/msrvtt_train/cvpr_2019/msrvtt_eval/dual_encoding_concate_full_dp_0.2_measure_exp/vocab_word_vocab_5_word_dim_500_text_rnn_size_512_text_norm_True_kernel_sizes_2-3-4_num_512/visual_feature_resnet-152-img1k-flatten0_outputos_visual_rnn_size_1024_visual_norm_True_kernel_sizes_2-3-4-5_num_512/mapping_text_0-2048_img_0-2048/loss_func_cont_margin_0.2_direction_all_max_violation_True_cost_style_sum/optimizer_adam_lr_0.0001_decay_0.99_grad_clip_2.0_val_metric_recall/runs_0/val_metric.txt exists.
overwrite
[BigFile] 26617x1000 instances loaded from ../VisualSearch/msrvtt_train/FeatureData/resnet-152-img1k-flatten0_outputos
[BigFile] 7706x1000 instances loaded from ../VisualSearch/msrvtt_eval/FeatureData/resnet-152-img1k-flatten0_outputos
[BigFile] 1743364x500 instances loaded from ../VisualSearch/word2vec/flickr/vec500flickr30m
('getting pre-trained parameter for word embedding initialization', (819, 500))
=======================Data Loaded=================================
>>>>>>>>>>>>>>>>>>>>
Contrastive Loss Used
Epoch[0 / 50] LR: 0.0001
----------

 128/1532 [=>............................] - ETA: 22s - loss: -0.0013
 256/1532 [====>.........................] - ETA: 13s - loss: -0.0011
 384/1532 [======>.......................] - ETA: 9s - loss: -0.0011 
 512/1532 [=========>....................] - ETA: 7s - loss: -0.0011
 640/1532 [===========>..................] - ETA: 5s - loss: -0.0011
 768/1532 [==============>...............] - ETA: 4s - loss: -0.0012
 896/1532 [================>.............] - ETA: 3s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 2s - loss: -0.0012
1152/1532 [=====================>........] - ETA: 1s - loss: -0.0012
1280/1532 [========================>.....] - ETA: 1s - loss: -0.0012
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0012
1532/1532 [==============================] - 8s 5ms/step - loss: -0.0012
 * Text to video:
 * r_1_5_10: [0.226, 0.903, 2.483]
 * medr, meanr: [181.0, 194.239]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 1.58, 2.709]
 * medr, meanr: [197.0, 209.429]
 * ----------
 * Current perf: 8.35214446953
 * Best perf: 8.35214446953

Epoch[1 / 50] LR: 9.9e-05
----------

 128/1532 [=>............................] - ETA: 5s - loss: -0.0012
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0012
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0011
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0011
 640/1532 [===========>..................] - ETA: 2s - loss: -0.0012
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0012
 896/1532 [================>.............] - ETA: 1s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 1s - loss: -0.0012
1152/1532 [=====================>........] - ETA: 1s - loss: -0.0012
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0012
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0012
1532/1532 [==============================] - 5s 3ms/step - loss: -0.0012
 * Text to video:
 * r_1_5_10: [0.677, 1.58, 3.386]
 * medr, meanr: [155.0, 175.255]
 * ----------
 * Video to text:
 * r_1_5_10: [0.0, 1.354, 2.483]
 * medr, meanr: [184.0, 197.246]
 * ----------
 * Current perf: 9.48081264108
 * Best perf: 9.48081264108

Epoch[2 / 50] LR: 9.801e-05
----------

 128/1532 [=>............................] - ETA: 6s - loss: -9.7704e-04
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0011    
 384/1532 [======>.......................] - ETA: 3s - loss: -0.0013
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0013
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0014
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0013
 896/1532 [================>.............] - ETA: 1s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 1s - loss: -0.0012
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0012
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0012
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0012
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0012
 * Text to video:
 * r_1_5_10: [0.451, 2.032, 3.16]
 * medr, meanr: [146.0, 170.061]
 * ----------
 * Video to text:
 * r_1_5_10: [0.226, 1.354, 2.483]
 * medr, meanr: [173.0, 191.302]
 * ----------
 * Current perf: 9.7065462754
 * Best perf: 9.7065462754

Epoch[3 / 50] LR: 9.70299e-05
----------

 128/1532 [=>............................] - ETA: 6s - loss: -0.0011
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0013
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0012
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0012
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0011
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0012
 896/1532 [================>.............] - ETA: 1s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 1s - loss: -0.0012
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0012
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0012
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0012
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0012
 * Text to video:
 * r_1_5_10: [0.226, 1.58, 3.386]
 * medr, meanr: [145.0, 172.138]
 * ----------
 * Video to text:
 * r_1_5_10: [0.226, 1.58, 3.837]
 * medr, meanr: [170.0, 188.535]
 * ----------
 * Current perf: 10.835214447
 * Best perf: 10.835214447

Epoch[4 / 50] LR: 9.6059601e-05
----------

 128/1532 [=>............................] - ETA: 5s - loss: -6.0994e-04
 256/1532 [====>.........................] - ETA: 3s - loss: -8.3359e-04
 384/1532 [======>.......................] - ETA: 2s - loss: -8.8035e-04
 512/1532 [=========>....................] - ETA: 2s - loss: -8.7580e-04
 640/1532 [===========>..................] - ETA: 1s - loss: -9.7453e-04
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0011    
 896/1532 [================>.............] - ETA: 1s - loss: -0.0011
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0011
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0012
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0012
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0012
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0012
 * Text to video:
 * r_1_5_10: [0.451, 1.806, 4.063]
 * medr, meanr: [157.0, 175.698]
 * ----------
 * Video to text:
 * r_1_5_10: [0.226, 2.032, 4.515]
 * medr, meanr: [170.0, 188.163]
 * ----------
 * Current perf: 13.0925507901
 * Best perf: 13.0925507901

Epoch[5 / 50] LR: 9.509900499e-05
----------

 128/1532 [=>............................] - ETA: 6s - loss: -0.0013
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0013
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0012
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0013
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0013
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0013
 896/1532 [================>.............] - ETA: 1s - loss: -0.0013
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0013
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0012
 * Text to video:
 * r_1_5_10: [0.226, 1.806, 4.289]
 * medr, meanr: [153.0, 174.501]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.257, 3.837]
 * medr, meanr: [165.0, 186.361]
 * ----------
 * Current perf: 12.8668171558
 * Best perf: 13.0925507901

Epoch[6 / 50] LR: 4.70740074701e-05
----------

 128/1532 [=>............................] - ETA: 5s - loss: -9.9052e-04
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0011    
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0011
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0012
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0012
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0012
 896/1532 [================>.............] - ETA: 1s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0012
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0012
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0012
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0012
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0012
 * Text to video:
 * r_1_5_10: [0.226, 1.354, 3.16]
 * medr, meanr: [149.0, 170.081]
 * ----------
 * Video to text:
 * r_1_5_10: [0.226, 1.806, 4.063]
 * medr, meanr: [171.0, 189.034]
 * ----------
 * Current perf: 10.835214447
 * Best perf: 13.0925507901

Epoch[7 / 50] LR: 4.66032673953e-05
----------

 128/1532 [=>............................] - ETA: 6s - loss: -0.0012
 256/1532 [====>.........................] - ETA: 4s - loss: -0.0012
 384/1532 [======>.......................] - ETA: 3s - loss: -0.0012
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0011
 640/1532 [===========>..................] - ETA: 2s - loss: -0.0011
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0012
 896/1532 [================>.............] - ETA: 1s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 1s - loss: -0.0012
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0012
 * Text to video:
 * r_1_5_10: [0.226, 1.58, 3.837]
 * medr, meanr: [151.0, 171.253]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.032, 4.063]
 * medr, meanr: [171.0, 190.059]
 * ----------
 * Current perf: 12.1896162528
 * Best perf: 13.0925507901

Epoch[8 / 50] LR: 4.61372347214e-05
----------

 128/1532 [=>............................] - ETA: 6s - loss: -0.0011
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0013
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0013
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0013
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0012
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0013
 896/1532 [================>.............] - ETA: 1s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 1s - loss: -0.0012
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0012
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0012
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0012
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 1.806, 4.289]
 * medr, meanr: [151.0, 171.623]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.257, 4.063]
 * medr, meanr: [176.0, 190.677]
 * ----------
 * Current perf: 13.0925507901
 * Best perf: 13.0925507901

Epoch[9 / 50] LR: 2.28379311871e-05
----------

 128/1532 [=>............................] - ETA: 6s - loss: -0.0013
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0012
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0013
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0013
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0012
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0012
 896/1532 [================>.............] - ETA: 1s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0012
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0012
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0012
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0012
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 2.032, 4.515]
 * medr, meanr: [151.0, 171.6]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 1.806, 4.063]
 * medr, meanr: [176.0, 190.695]
 * ----------
 * Current perf: 13.0925507901
 * Best perf: 13.0925507901

Epoch[10 / 50] LR: 2.26095518752e-05
----------

 128/1532 [=>............................] - ETA: 6s - loss: -0.0012
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0014
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0013
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0014
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0014
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0013
 896/1532 [================>.............] - ETA: 1s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0013
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 2.032, 5.192]
 * medr, meanr: [149.0, 171.065]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.483, 4.289]
 * medr, meanr: [175.0, 190.865]
 * ----------
 * Current perf: 14.6726862302
 * Best perf: 14.6726862302

Epoch[11 / 50] LR: 2.23834563565e-05
----------

 128/1532 [=>............................] - ETA: 5s - loss: -0.0010
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0013
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0011
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0012
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0011
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0012
 896/1532 [================>.............] - ETA: 1s - loss: -0.0013
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0013
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 2.032, 4.74]
 * medr, meanr: [150.0, 170.117]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.032, 4.289]
 * medr, meanr: [175.0, 190.716]
 * ----------
 * Current perf: 13.769751693
 * Best perf: 14.6726862302

Epoch[12 / 50] LR: 1.10798108965e-05
----------

 128/1532 [=>............................] - ETA: 6s - loss: -0.0013
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0013
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0012
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0012
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0012
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0013
 896/1532 [================>.............] - ETA: 1s - loss: -0.0013
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0013
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0012
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 2.032, 5.418]
 * medr, meanr: [146.0, 168.664]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.257, 3.837]
 * medr, meanr: [174.0, 190.298]
 * ----------
 * Current perf: 14.2212189616
 * Best perf: 14.6726862302

Epoch[13 / 50] LR: 1.09690127875e-05
----------

 128/1532 [=>............................] - ETA: 5s - loss: -7.9335e-04
 256/1532 [====>.........................] - ETA: 3s - loss: -9.5557e-04
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0011    
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0012
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0012
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0013
 896/1532 [================>.............] - ETA: 1s - loss: -0.0013
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0014
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 1.354, 4.966]
 * medr, meanr: [148.0, 168.851]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.032, 4.063]
 * medr, meanr: [173.0, 189.767]
 * ----------
 * Current perf: 13.0925507901
 * Best perf: 14.6726862302

Epoch[14 / 50] LR: 1.08593226596e-05
----------

 128/1532 [=>............................] - ETA: 6s - loss: -9.3480e-04
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0015    
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0012
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0013
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0014
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0014
 896/1532 [================>.............] - ETA: 1s - loss: -0.0013
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0013
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 1.58, 4.289]
 * medr, meanr: [147.0, 168.754]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.483, 4.063]
 * medr, meanr: [174.0, 189.851]
 * ----------
 * Current perf: 13.0925507901
 * Best perf: 14.6726862302

Epoch[15 / 50] LR: 5.37536471651e-06
----------

 128/1532 [=>............................] - ETA: 5s - loss: -0.0013
 256/1532 [====>.........................] - ETA: 3s - loss: -9.9849e-04
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0010    
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0012
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0012
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0012
 896/1532 [================>.............] - ETA: 1s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0012
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 1.806, 4.74]
 * medr, meanr: [147.0, 168.758]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.032, 4.063]
 * medr, meanr: [173.0, 189.596]
 * ----------
 * Current perf: 13.3182844244
 * Best perf: 14.6726862302

Epoch[16 / 50] LR: 5.32161106934e-06
----------

 128/1532 [=>............................] - ETA: 6s - loss: -9.3164e-04
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0013    
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0013
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0013
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0013
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0013
 896/1532 [================>.............] - ETA: 1s - loss: -0.0013
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0013
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 1.806, 4.515]
 * medr, meanr: [147.0, 168.47]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.257, 4.289]
 * medr, meanr: [174.0, 189.609]
 * ----------
 * Current perf: 13.5440180587
 * Best perf: 14.6726862302

Epoch[17 / 50] LR: 5.26839495865e-06
----------

 128/1532 [=>............................] - ETA: 5s - loss: -0.0013
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0011
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0012
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0013
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0013
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0013
 896/1532 [================>.............] - ETA: 1s - loss: -0.0013
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0014
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 1.58, 4.289]
 * medr, meanr: [147.0, 169.402]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.257, 4.063]
 * medr, meanr: [169.0, 189.174]
 * ----------
 * Current perf: 12.8668171558
 * Best perf: 14.6726862302

Epoch[18 / 50] LR: 2.60785550453e-06
----------

 128/1532 [=>............................] - ETA: 6s - loss: -0.0016
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0013
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0013
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0012
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0013
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0013
 896/1532 [================>.............] - ETA: 1s - loss: -0.0013
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0013
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 1.354, 4.515]
 * medr, meanr: [148.0, 169.02]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.483, 4.063]
 * medr, meanr: [172.0, 189.054]
 * ----------
 * Current perf: 13.0925507901
 * Best perf: 14.6726862302

Epoch[19 / 50] LR: 2.58177694949e-06
----------

 128/1532 [=>............................] - ETA: 5s - loss: -9.7364e-04
 256/1532 [====>.........................] - ETA: 3s - loss: -9.8933e-04
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0011    
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0012
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0013
 768/1532 [==============>...............] - ETA: 2s - loss: -0.0014
 896/1532 [================>.............] - ETA: 1s - loss: -0.0013
1024/1532 [===================>..........] - ETA: 1s - loss: -0.0013
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0012
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 1.58, 4.74]
 * medr, meanr: [149.0, 169.594]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.257, 4.063]
 * medr, meanr: [170.0, 188.962]
 * ----------
 * Current perf: 13.3182844244
 * Best perf: 14.6726862302

Epoch[20 / 50] LR: 2.55595917999e-06
----------

 128/1532 [=>............................] - ETA: 6s - loss: -0.0011
 256/1532 [====>.........................] - ETA: 3s - loss: -0.0013
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0011
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0012
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0012
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0012
 896/1532 [================>.............] - ETA: 1s - loss: -0.0012
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0013
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 1.58, 4.289]
 * medr, meanr: [149.0, 169.339]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.032, 4.063]
 * medr, meanr: [171.0, 188.86]
 * ----------
 * Current perf: 12.6410835214
 * Best perf: 14.6726862302

Epoch[21 / 50] LR: 1.2651997941e-06
----------

 128/1532 [=>............................] - ETA: 6s - loss: -0.0017
 256/1532 [====>.........................] - ETA: 4s - loss: -0.0014
 384/1532 [======>.......................] - ETA: 2s - loss: -0.0013
 512/1532 [=========>....................] - ETA: 2s - loss: -0.0013
 640/1532 [===========>..................] - ETA: 1s - loss: -0.0013
 768/1532 [==============>...............] - ETA: 1s - loss: -0.0013
 896/1532 [================>.............] - ETA: 1s - loss: -0.0013
1024/1532 [===================>..........] - ETA: 0s - loss: -0.0013
1152/1532 [=====================>........] - ETA: 0s - loss: -0.0013
1280/1532 [========================>.....] - ETA: 0s - loss: -0.0013
1408/1532 [==========================>...] - ETA: 0s - loss: -0.0013
1532/1532 [==============================] - 3s 2ms/step - loss: -0.0013
 * Text to video:
 * r_1_5_10: [0.226, 1.58, 4.515]
 * medr, meanr: [149.0, 169.813]
 * ----------
 * Video to text:
 * r_1_5_10: [0.451, 2.257, 4.063]
 * medr, meanr: [170.0, 188.806]
 * ----------
 * Current perf: 13.0925507901
 * Best perf: 14.6726862302

Early stopping happended.

best performance on validation: 14.6726862302

<type 'type'>
{
  "checkpoint_name": "model_best.pth.tar", 
  "workers": 5, 
  "rootpath": "../VisualSearch", 
  "batch_size": 128, 
  "log_step": 10, 
  "logger_name": "../VisualSearch/msrvtt_train/cvpr_2019/msrvtt_eval/dual_encoding_concate_full_dp_0.2_measure_exp/vocab_word_vocab_5_word_dim_500_text_rnn_size_512_text_norm_True_kernel_sizes_2-3-4_num_512/visual_feature_resnet-152-img1k-flatten0_outputos_visual_rnn_size_1024_visual_norm_True_kernel_sizes_2-3-4-5_num_512/mapping_text_0-2048_img_0-2048/loss_func_cont_margin_0.2_direction_all_max_violation_True_cost_style_sum/optimizer_adam_lr_0.0001_decay_0.99_grad_clip_2.0_val_metric_recall/runs_0", 
  "testCollection": "msrvtt_test", 
  "n_caption": 1, 
  "overwrite": 1
}
=> loaded checkpoint '../VisualSearch/msrvtt_train/cvpr_2019/msrvtt_eval/dual_encoding_concate_full_dp_0.2_measure_exp/vocab_word_vocab_5_word_dim_500_text_rnn_size_512_text_norm_True_kernel_sizes_2-3-4_num_512/visual_feature_resnet-152-img1k-flatten0_outputos_visual_rnn_size_1024_visual_norm_True_kernel_sizes_2-3-4-5_num_512/mapping_text_0-2048_img_0-2048/loss_func_cont_margin_0.2_direction_all_max_violation_True_cost_style_sum/optimizer_adam_lr_0.0001_decay_0.99_grad_clip_2.0_val_metric_recall/runs_0/model_best.pth.tar' (epoch 11, best_rsum 14.6726862302)
../VisualSearch/msrvtt_test/results/msrvtt_train/msrvtt_eval/dual_encoding_concate_full_dp_0.2_measure_exp/vocab_word_vocab_5_word_dim_500_text_rnn_size_512_text_norm_True_kernel_sizes_2-3-4_num_512/visual_feature_resnet-152-img1k-flatten0_outputos_visual_rnn_size_1024_visual_norm_True_kernel_sizes_2-3-4-5_num_512/mapping_text_0-2048_img_0-2048/loss_func_cont_margin_0.2_direction_all_max_violation_True_cost_style_sum/optimizer_adam_lr_0.0001_decay_0.99_grad_clip_2.0_val_metric_recall/runs_0/model_best.pth.tar/pred_errors_matrix.pth.tar exists.
overwrite
[BigFile] 3525x1000 instances loaded from ../VisualSearch/msrvtt_test/FeatureData/resnet-152-img1k-flatten0_outputos
>>>>>>>>>>>>>>>>>>>>
Contrastive Loss Used
write into: ../VisualSearch/msrvtt_test/results/msrvtt_train/msrvtt_eval/dual_encoding_concate_full_dp_0.2_measure_exp/vocab_word_vocab_5_word_dim_500_text_rnn_size_512_text_norm_True_kernel_sizes_2-3-4_num_512/visual_feature_resnet-152-img1k-flatten0_outputos_visual_rnn_size_1024_visual_norm_True_kernel_sizes_2-3-4-5_num_512/mapping_text_0-2048_img_0-2048/loss_func_cont_margin_0.2_direction_all_max_violation_True_cost_style_sum/optimizer_adam_lr_0.0001_decay_0.99_grad_clip_2.0_val_metric_recall/runs_0/model_best.pth.tar/pred_errors_matrix.pth.tar
 * Text to Video:
 * r_1_5_10, medr, meanr: [1.0, 7.7, 10.1, 75.0, 83.7]
 * recall sum: 18.8
 * mAP: 0.051
 * ----------
 * Video to text:
 * r_1_5_10, medr, meanr: [1.0, 4.8, 6.8, 88.0, 90.6]
 * recall sum: 12.6
 * mAP: 0.04
 * ----------
