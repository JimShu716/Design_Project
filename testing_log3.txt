{
  "checkpoint_name": "model_best.pth.tar", 
  "workers": 5, 
  "rootpath": "/usr/local/extstore01/gengyi/VisualSearch", 
  "batch_size": 128, 
  "log_step": 10, 
  "logger_name": "/usr/local/extstore01/gengyi/VisualSearch/msrvtt10ktrain/cvpr_2019", 
  "testCollection": "msrvtt10ktest", 
  "n_caption": 20, 
  "overwrite": 0
}
=> loaded checkpoint '/usr/local/extstore01/gengyi/VisualSearch/msrvtt10ktrain/cvpr_2019/model_best.pth.tar' (epoch 10, best_rsum 292.334004024)
[BigFile] 305462x2048 instances loaded from /usr/local/extstore01/gengyi/VisualSearch/msrvtt10ktest/FeatureData/resnet-152-img1k-flatten0_outputos
Video_multilevel_encoding(
  (dropout): Dropout(p=0.2)
  (rnn): GRU(2048, 1024, batch_first=True, bidirectional=True)
  (convs1): ModuleList(
    (0): Conv2d(1, 512, kernel_size=(2, 2048), stride=(1, 1), padding=(1, 0))
    (1): Conv2d(1, 512, kernel_size=(3, 2048), stride=(1, 1), padding=(2, 0))
    (2): Conv2d(1, 512, kernel_size=(4, 2048), stride=(1, 1), padding=(3, 0))
    (3): Conv2d(1, 512, kernel_size=(5, 2048), stride=(1, 1), padding=(4, 0))
  )
  (visual_mapping): MFC(
    (fc1): Linear(in_features=6144, out_features=2048, bias=True)
    (dropout): Dropout(p=0.2)
    (bn_1): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
)
Text_multilevel_encoding(
  (dropout): Dropout(p=0.2)
  (embed): Embedding(7811, 500)
  (rnn): GRU(500, 512, batch_first=True, bidirectional=True)
  (convs1): ModuleList(
    (0): Conv2d(1, 512, kernel_size=(2, 1024), stride=(1, 1), padding=(1, 0))
    (1): Conv2d(1, 512, kernel_size=(3, 1024), stride=(1, 1), padding=(2, 0))
    (2): Conv2d(1, 512, kernel_size=(4, 1024), stride=(1, 1), padding=(3, 0))
  )
  (text_mapping): MFC(
    (fc1): Linear(in_features=10367, out_features=2048, bias=True)
    (dropout): Dropout(p=0.2)
    (bn_1): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
)
Running MSRVTT

 128/2990 [>.............................] - ETA: 30s
 256/2990 [=>............................] - ETA: 19s
 384/2990 [==>...........................] - ETA: 15s
 512/2990 [====>.........................] - ETA: 11s
 640/2990 [=====>........................] - ETA: 9s 
 768/2990 [======>.......................] - ETA: 7s
 896/2990 [=======>......................] - ETA: 6s
1024/2990 [=========>....................] - ETA: 5s
1152/2990 [==========>...................] - ETA: 5s
1280/2990 [===========>..................] - ETA: 4s
1408/2990 [=============>................] - ETA: 3s
1536/2990 [==============>...............] - ETA: 3s
1664/2990 [===============>..............] - ETA: 3s
1792/2990 [================>.............] - ETA: 2s
1920/2990 [==================>...........] - ETA: 2s
2048/2990 [===================>..........] - ETA: 2s
2176/2990 [====================>.........] - ETA: 1s
2304/2990 [======================>.......] - ETA: 1s
2432/2990 [=======================>......] - ETA: 1s
2560/2990 [========================>.....] - ETA: 0s
2688/2990 [=========================>....] - ETA: 0s
2816/2990 [===========================>..] - ETA: 0s
2944/2990 [============================>.] - ETA: 0s
2990/2990 [==============================] - 6s 2ms/step

  128/59800 [..............................] - ETA: 3:51
  256/59800 [..............................] - ETA: 2:13
  512/59800 [..............................] - ETA: 1:14
  768/59800 [..............................] - ETA: 59s 
  896/59800 [..............................] - ETA: 56s
 1024/59800 [..............................] - ETA: 54s
 1152/59800 [..............................] - ETA: 52s
 1408/59800 [..............................] - ETA: 46s
 1664/59800 [..............................] - ETA: 43s
 1792/59800 [..............................] - ETA: 42s
 2048/59800 [>.............................] - ETA: 39s
 2304/59800 [>.............................] - ETA: 37s
 2560/59800 [>.............................] - ETA: 35s
 2816/59800 [>.............................] - ETA: 32s
 3072/59800 [>.............................] - ETA: 31s
 3328/59800 [>.............................] - ETA: 29s
 3584/59800 [>.............................] - ETA: 28s
 3840/59800 [>.............................] - ETA: 27s
 4096/59800 [=>............................] - ETA: 27s
 4352/59800 [=>............................] - ETA: 26s
 4608/59800 [=>............................] - ETA: 25s
 4864/59800 [=>............................] - ETA: 24s
 5120/59800 [=>............................] - ETA: 24s
 5376/59800 [=>............................] - ETA: 24s
 5632/59800 [=>............................] - ETA: 23s
 5888/59800 [=>............................] - ETA: 23s
 6144/59800 [==>...........................] - ETA: 22s
 6400/59800 [==>...........................] - ETA: 22s
 6528/59800 [==>...........................] - ETA: 22s
 6784/59800 [==>...........................] - ETA: 22s
 6912/59800 [==>...........................] - ETA: 22s
 7040/59800 [==>...........................] - ETA: 22s
 7296/59800 [==>...........................] - ETA: 21s
 7552/59800 [==>...........................] - ETA: 21s
 7808/59800 [==>...........................] - ETA: 21s
 8064/59800 [===>..........................] - ETA: 21s
 8320/59800 [===>..........................] - ETA: 20s
 8576/59800 [===>..........................] - ETA: 20s
 8832/59800 [===>..........................] - ETA: 20s
 9088/59800 [===>..........................] - ETA: 20s
 9344/59800 [===>..........................] - ETA: 20s
 9600/59800 [===>..........................] - ETA: 20s
 9856/59800 [===>..........................] - ETA: 19s
10112/59800 [====>.........................] - ETA: 19s
10240/59800 [====>.........................] - ETA: 19s
10496/59800 [====>.........................] - ETA: 19s
10752/59800 [====>.........................] - ETA: 19s
11008/59800 [====>.........................] - ETA: 18s
11264/59800 [====>.........................] - ETA: 18s
11520/59800 [====>.........................] - ETA: 18s
11776/59800 [====>.........................] - ETA: 18s
12032/59800 [=====>........................] - ETA: 18s
12288/59800 [=====>........................] - ETA: 17s
12544/59800 [=====>........................] - ETA: 17s
12800/59800 [=====>........................] - ETA: 17s
13056/59800 [=====>........................] - ETA: 17s
13312/59800 [=====>........................] - ETA: 17s
13440/59800 [=====>........................] - ETA: 17s
13696/59800 [=====>........................] - ETA: 17s
13952/59800 [=====>........................] - ETA: 16s
14208/59800 [======>.......................] - ETA: 16s
14464/59800 [======>.......................] - ETA: 16s
14720/59800 [======>.......................] - ETA: 16s
14976/59800 [======>.......................] - ETA: 16s
15232/59800 [======>.......................] - ETA: 15s
15488/59800 [======>.......................] - ETA: 15s
15744/59800 [======>.......................] - ETA: 15s
16000/59800 [=======>......................] - ETA: 15s
16256/59800 [=======>......................] - ETA: 15s
16512/59800 [=======>......................] - ETA: 15s
16768/59800 [=======>......................] - ETA: 14s
16896/59800 [=======>......................] - ETA: 14s
17024/59800 [=======>......................] - ETA: 14s
17152/59800 [=======>......................] - ETA: 14s
17408/59800 [=======>......................] - ETA: 14s
17664/59800 [=======>......................] - ETA: 14s
17920/59800 [=======>......................] - ETA: 14s
18176/59800 [========>.....................] - ETA: 14s
18432/59800 [========>.....................] - ETA: 14s
18688/59800 [========>.....................] - ETA: 14s
18944/59800 [========>.....................] - ETA: 14s
19200/59800 [========>.....................] - ETA: 13s
19456/59800 [========>.....................] - ETA: 13s
19712/59800 [========>.....................] - ETA: 13s
19968/59800 [=========>....................] - ETA: 13s
20224/59800 [=========>....................] - ETA: 13s
20480/59800 [=========>....................] - ETA: 13s
20736/59800 [=========>....................] - ETA: 13s
20992/59800 [=========>....................] - ETA: 13s
21248/59800 [=========>....................] - ETA: 12s
21504/59800 [=========>....................] - ETA: 12s
21760/59800 [=========>....................] - ETA: 12s
22016/59800 [==========>...................] - ETA: 12s
22272/59800 [==========>...................] - ETA: 12s
22528/59800 [==========>...................] - ETA: 12s
22784/59800 [==========>...................] - ETA: 12s
23040/59800 [==========>...................] - ETA: 12s
23296/59800 [==========>...................] - ETA: 12s
23552/59800 [==========>...................] - ETA: 12s
23936/59800 [===========>..................] - ETA: 11s
24064/59800 [===========>..................] - ETA: 11s
24320/59800 [===========>..................] - ETA: 11s
24448/59800 [===========>..................] - ETA: 11s
24704/59800 [===========>..................] - ETA: 11s
24960/59800 [===========>..................] - ETA: 11s
25216/59800 [===========>..................] - ETA: 11s
25472/59800 [===========>..................] - ETA: 11s
25728/59800 [===========>..................] - ETA: 11s
25984/59800 [============>.................] - ETA: 11s
26240/59800 [============>.................] - ETA: 10s
26496/59800 [============>.................] - ETA: 10s
26752/59800 [============>.................] - ETA: 10s
27008/59800 [============>.................] - ETA: 10s
27264/59800 [============>.................] - ETA: 10s
27520/59800 [============>.................] - ETA: 10s
27776/59800 [============>.................] - ETA: 10s
28032/59800 [=============>................] - ETA: 10s
28288/59800 [=============>................] - ETA: 10s
28544/59800 [=============>................] - ETA: 10s
28800/59800 [=============>................] - ETA: 9s 
29056/59800 [=============>................] - ETA: 9s
29312/59800 [=============>................] - ETA: 9s
29568/59800 [=============>................] - ETA: 9s
29824/59800 [=============>................] - ETA: 9s
30208/59800 [==============>...............] - ETA: 9s
30464/59800 [==============>...............] - ETA: 9s
30720/59800 [==============>...............] - ETA: 9s
30976/59800 [==============>...............] - ETA: 9s
31232/59800 [==============>...............] - ETA: 9s
31488/59800 [==============>...............] - ETA: 8s
31744/59800 [==============>...............] - ETA: 8s
31872/59800 [==============>...............] - ETA: 8s
32128/59800 [===============>..............] - ETA: 8s
32384/59800 [===============>..............] - ETA: 8s
32640/59800 [===============>..............] - ETA: 8s
32896/59800 [===============>..............] - ETA: 8s
33152/59800 [===============>..............] - ETA: 8s
33408/59800 [===============>..............] - ETA: 8s
33536/59800 [===============>..............] - ETA: 8s
33792/59800 [===============>..............] - ETA: 8s
34048/59800 [================>.............] - ETA: 8s
34304/59800 [================>.............] - ETA: 8s
34560/59800 [================>.............] - ETA: 8s
34944/59800 [================>.............] - ETA: 7s
35200/59800 [================>.............] - ETA: 7s
35456/59800 [================>.............] - ETA: 7s
35712/59800 [================>.............] - ETA: 7s
36096/59800 [=================>............] - ETA: 7s
36352/59800 [=================>............] - ETA: 7s
36608/59800 [=================>............] - ETA: 7s
36736/59800 [=================>............] - ETA: 7s
36992/59800 [=================>............] - ETA: 7s
37248/59800 [=================>............] - ETA: 7s
37504/59800 [=================>............] - ETA: 7s
37760/59800 [=================>............] - ETA: 6s
38016/59800 [==================>...........] - ETA: 6s
38272/59800 [==================>...........] - ETA: 6s
38528/59800 [==================>...........] - ETA: 6s
38784/59800 [==================>...........] - ETA: 6s
39040/59800 [==================>...........] - ETA: 6s
39296/59800 [==================>...........] - ETA: 6s
39552/59800 [==================>...........] - ETA: 6s
39808/59800 [==================>...........] - ETA: 6s
40064/59800 [===================>..........] - ETA: 6s
40320/59800 [===================>..........] - ETA: 6s
40576/59800 [===================>..........] - ETA: 6s
40832/59800 [===================>..........] - ETA: 5s
40960/59800 [===================>..........] - ETA: 5s
41088/59800 [===================>..........] - ETA: 5s
41216/59800 [===================>..........] - ETA: 5s
41472/59800 [===================>..........] - ETA: 5s
41728/59800 [===================>..........] - ETA: 5s
41984/59800 [====================>.........] - ETA: 5s
42240/59800 [====================>.........] - ETA: 5s
42496/59800 [====================>.........] - ETA: 5s
42752/59800 [====================>.........] - ETA: 5s
43008/59800 [====================>.........] - ETA: 5s
43136/59800 [====================>.........] - ETA: 5s
43392/59800 [====================>.........] - ETA: 5s
43648/59800 [====================>.........] - ETA: 5s
43776/59800 [====================>.........] - ETA: 5s
44032/59800 [=====================>........] - ETA: 5s
44288/59800 [=====================>........] - ETA: 5s
44544/59800 [=====================>........] - ETA: 4s
44800/59800 [=====================>........] - ETA: 4s
45056/59800 [=====================>........] - ETA: 4s
45312/59800 [=====================>........] - ETA: 4s
45568/59800 [=====================>........] - ETA: 4s
45824/59800 [=====================>........] - ETA: 4s
46080/59800 [======================>.......] - ETA: 4s
46208/59800 [======================>.......] - ETA: 4s
46464/59800 [======================>.......] - ETA: 4s
46720/59800 [======================>.......] - ETA: 4s
46848/59800 [======================>.......] - ETA: 4s
46976/59800 [======================>.......] - ETA: 4s
47232/59800 [======================>.......] - ETA: 4s
47488/59800 [======================>.......] - ETA: 4s
47744/59800 [======================>.......] - ETA: 3s
47872/59800 [=======================>......] - ETA: 3s
48000/59800 [=======================>......] - ETA: 3s
48256/59800 [=======================>......] - ETA: 3s
48512/59800 [=======================>......] - ETA: 3s
48768/59800 [=======================>......] - ETA: 3s
49024/59800 [=======================>......] - ETA: 3s
49280/59800 [=======================>......] - ETA: 3s
49536/59800 [=======================>......] - ETA: 3s
49792/59800 [=======================>......] - ETA: 3s
50048/59800 [========================>.....] - ETA: 3s
50304/59800 [========================>.....] - ETA: 3s
50560/59800 [========================>.....] - ETA: 3s
50816/59800 [========================>.....] - ETA: 2s
51072/59800 [========================>.....] - ETA: 2s
51200/59800 [========================>.....] - ETA: 2s
51456/59800 [========================>.....] - ETA: 2s
51712/59800 [========================>.....] - ETA: 2s
51968/59800 [=========================>....] - ETA: 2s
52096/59800 [=========================>....] - ETA: 2s
52224/59800 [=========================>....] - ETA: 2s
52480/59800 [=========================>....] - ETA: 2s
52736/59800 [=========================>....] - ETA: 2s
52992/59800 [=========================>....] - ETA: 2s
53248/59800 [=========================>....] - ETA: 2s
53504/59800 [=========================>....] - ETA: 2s
53760/59800 [=========================>....] - ETA: 2s
54016/59800 [==========================>...] - ETA: 1s
54272/59800 [==========================>...] - ETA: 1s
54528/59800 [==========================>...] - ETA: 1s
54784/59800 [==========================>...] - ETA: 1s
55040/59800 [==========================>...] - ETA: 1s
55296/59800 [==========================>...] - ETA: 1s
55552/59800 [==========================>...] - ETA: 1s
55808/59800 [==========================>...] - ETA: 1s
56064/59800 [===========================>..] - ETA: 1s
56320/59800 [===========================>..] - ETA: 1s
56576/59800 [===========================>..] - ETA: 1s
56832/59800 [===========================>..] - ETA: 0s
57216/59800 [===========================>..] - ETA: 0s
57472/59800 [===========================>..] - ETA: 0s
57728/59800 [===========================>..] - ETA: 0s
57984/59800 [============================>.] - ETA: 0s
58240/59800 [============================>.] - ETA: 0s
58496/59800 [============================>.] - ETA: 0s
58752/59800 [============================>.] - ETA: 0s
59008/59800 [============================>.] - ETA: 0s
59264/59800 [============================>.] - ETA: 0s
59520/59800 [============================>.] - ETA: 0s
59648/59800 [============================>.] - ETA: 0s
59800/59800 [==============================] - 20s 330us/step
write into: /usr/local/extstore01/gengyi/VisualSearch/msrvtt10ktest/results/msrvtt10ktrain/model_best.pth.tar/pred_errors_matrix.pth.tar
Running MSRVTT
Type of e is : <type 'int'>
0
eval shape: (2990, 59800)
Type of e is : <type 'int'>
0
eval shape: (59800, 2990)
 * Text to Video:
 * r_1_5_10, medr, meanr: [7.7, 22.3, 31.8, 33.0, 206.8]
 * recall sum: 61.8
 * mAP: 0.155
 * ----------
 * Video to text:
 * r_1_5_10, medr, meanr: [13.0, 30.3, 42.3, 16.0, 123.3]
 * recall sum: 85.6
 * mAP: 0.065
 * ----------
