{
  "checkpoint_name": "model_best.pth.tar", 
  "workers": 5, 
  "rootpath": "/usr/local/extstore01/gengyi/VisualSearch", 
  "batch_size": 128, 
  "log_step": 10, 
  "logger_name": "/usr/local/extstore01/gengyi/VisualSearch/msrvtt10ktrain/cvpr_2019", 
  "testCollection": "msrvtt10ktest", 
  "n_caption": 20, 
  "overwrite": 0
}
=> loaded checkpoint '/usr/local/extstore01/gengyi/VisualSearch/msrvtt10ktrain/cvpr_2019/model_best.pth.tar' (epoch 10, best_rsum 292.334004024)
[BigFile] 305462x2048 instances loaded from /usr/local/extstore01/gengyi/VisualSearch/msrvtt10ktest/FeatureData/resnet-152-img1k-flatten0_outputos
Video_multilevel_encoding(
  (dropout): Dropout(p=0.2)
  (rnn): GRU(2048, 1024, batch_first=True, bidirectional=True)
  (convs1): ModuleList(
    (0): Conv2d(1, 512, kernel_size=(2, 2048), stride=(1, 1), padding=(1, 0))
    (1): Conv2d(1, 512, kernel_size=(3, 2048), stride=(1, 1), padding=(2, 0))
    (2): Conv2d(1, 512, kernel_size=(4, 2048), stride=(1, 1), padding=(3, 0))
    (3): Conv2d(1, 512, kernel_size=(5, 2048), stride=(1, 1), padding=(4, 0))
  )
  (visual_mapping): MFC(
    (fc1): Linear(in_features=6144, out_features=2048, bias=True)
    (dropout): Dropout(p=0.2)
    (bn_1): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True)
  )
)
Text_multilevel_encoding(
  (dropout): Dropout(p=0.2)
  (embed): Embedding(7811, 500)
  (rnn): GRU(500, 512, batch_first=True, bidirectional=True)
  (convs1): ModuleList(
    (0): Conv2d(1, 512, kernel_size=(2, 1024), stride=(1, 1), padding=(1, 0))
    (1): Conv2d(1, 512, kernel_size=(3, 1024), stride=(1, 1), padding=(2, 0))
    (2): Conv2d(1, 512, kernel_size=(4, 1024), stride=(1, 1), padding=(3, 0))
  )
  (text_mapping): MFC(
    (fc1): Linear(in_features=10367, out_features=2048, bias=True)
    (dropout): Dropout(p=0.2)
    (bn_1): BatchNorm1d(2048, eps=1e-05, momentum=0.1, affine=True)
  )
)
Running MSRVTT

 128/2990 [>.............................] - ETA: 21:37
 256/2990 [=>............................] - ETA: 10:25
 384/2990 [==>...........................] - ETA: 6:40 
 512/2990 [====>.........................] - ETA: 4:46
 640/2990 [=====>........................] - ETA: 3:38
 768/2990 [======>.......................] - ETA: 2:52
 896/2990 [=======>......................] - ETA: 2:19
1024/2990 [=========>....................] - ETA: 1:54
1152/2990 [==========>...................] - ETA: 1:35
1280/2990 [===========>..................] - ETA: 1:20
1408/2990 [=============>................] - ETA: 1:07
1536/2990 [==============>...............] - ETA: 57s 
1664/2990 [===============>..............] - ETA: 48s
1792/2990 [================>.............] - ETA: 40s
1920/2990 [==================>...........] - ETA: 34s
2048/2990 [===================>..........] - ETA: 28s
2176/2990 [====================>.........] - ETA: 23s
2304/2990 [======================>.......] - ETA: 18s
2432/2990 [=======================>......] - ETA: 14s
2560/2990 [========================>.....] - ETA: 10s
2688/2990 [=========================>....] - ETA: 7s 
2816/2990 [===========================>..] - ETA: 3s
2944/2990 [============================>.] - ETA: 0s
2990/2990 [==============================] - 63s 21ms/step

  128/59800 [..............................] - ETA: 11:15
  256/59800 [..............................] - ETA: 5:55 
  512/59800 [..............................] - ETA: 3:11
  640/59800 [..............................] - ETA: 2:41
  768/59800 [..............................] - ETA: 2:20
  896/59800 [..............................] - ETA: 2:05
 1024/59800 [..............................] - ETA: 1:56
 1152/59800 [..............................] - ETA: 1:46
 1408/59800 [..............................] - ETA: 1:29
 1664/59800 [..............................] - ETA: 1:20
 1792/59800 [..............................] - ETA: 1:17
 2048/59800 [>.............................] - ETA: 1:10
 2304/59800 [>.............................] - ETA: 1:05
 2560/59800 [>.............................] - ETA: 1:00
 2816/59800 [>.............................] - ETA: 55s 
 3072/59800 [>.............................] - ETA: 52s
 3328/59800 [>.............................] - ETA: 49s
 3584/59800 [>.............................] - ETA: 46s
 3840/59800 [>.............................] - ETA: 44s
 4096/59800 [=>............................] - ETA: 43s
 4352/59800 [=>............................] - ETA: 41s
 4608/59800 [=>............................] - ETA: 39s
 4864/59800 [=>............................] - ETA: 38s
 5120/59800 [=>............................] - ETA: 37s
 5376/59800 [=>............................] - ETA: 36s
 5632/59800 [=>............................] - ETA: 35s
 5888/59800 [=>............................] - ETA: 34s
 6144/59800 [==>...........................] - ETA: 33s
 6400/59800 [==>...........................] - ETA: 32s
 6656/59800 [==>...........................] - ETA: 32s
 6912/59800 [==>...........................] - ETA: 31s
 7168/59800 [==>...........................] - ETA: 30s
 7296/59800 [==>...........................] - ETA: 30s
 7552/59800 [==>...........................] - ETA: 30s
 7808/59800 [==>...........................] - ETA: 29s
 8064/59800 [===>..........................] - ETA: 29s
 8320/59800 [===>..........................] - ETA: 28s
 8576/59800 [===>..........................] - ETA: 28s
 8832/59800 [===>..........................] - ETA: 27s
 9088/59800 [===>..........................] - ETA: 27s
 9344/59800 [===>..........................] - ETA: 27s
 9600/59800 [===>..........................] - ETA: 26s
 9856/59800 [===>..........................] - ETA: 26s
10112/59800 [====>.........................] - ETA: 25s
10240/59800 [====>.........................] - ETA: 26s
10496/59800 [====>.........................] - ETA: 25s
10752/59800 [====>.........................] - ETA: 25s
11008/59800 [====>.........................] - ETA: 24s
11136/59800 [====>.........................] - ETA: 24s
11520/59800 [====>.........................] - ETA: 24s
11776/59800 [====>.........................] - ETA: 23s
12032/59800 [=====>........................] - ETA: 23s
12160/59800 [=====>........................] - ETA: 23s
12288/59800 [=====>........................] - ETA: 23s
12416/59800 [=====>........................] - ETA: 23s
12672/59800 [=====>........................] - ETA: 22s
12928/59800 [=====>........................] - ETA: 22s
13184/59800 [=====>........................] - ETA: 22s
13440/59800 [=====>........................] - ETA: 22s
13696/59800 [=====>........................] - ETA: 21s
13952/59800 [=====>........................] - ETA: 21s
14208/59800 [======>.......................] - ETA: 21s
14464/59800 [======>.......................] - ETA: 21s
14720/59800 [======>.......................] - ETA: 20s
14976/59800 [======>.......................] - ETA: 20s
15232/59800 [======>.......................] - ETA: 20s
15488/59800 [======>.......................] - ETA: 20s
15744/59800 [======>.......................] - ETA: 19s
16000/59800 [=======>......................] - ETA: 19s
16256/59800 [=======>......................] - ETA: 19s
16512/59800 [=======>......................] - ETA: 19s
16768/59800 [=======>......................] - ETA: 18s
17024/59800 [=======>......................] - ETA: 18s
17280/59800 [=======>......................] - ETA: 18s
17536/59800 [=======>......................] - ETA: 18s
17792/59800 [=======>......................] - ETA: 18s
17920/59800 [=======>......................] - ETA: 18s
18176/59800 [========>.....................] - ETA: 18s
18432/59800 [========>.....................] - ETA: 17s
18688/59800 [========>.....................] - ETA: 17s
18944/59800 [========>.....................] - ETA: 17s
19200/59800 [========>.....................] - ETA: 17s
19456/59800 [========>.....................] - ETA: 17s
19712/59800 [========>.....................] - ETA: 16s
19968/59800 [=========>....................] - ETA: 16s
20224/59800 [=========>....................] - ETA: 16s
20480/59800 [=========>....................] - ETA: 16s
20736/59800 [=========>....................] - ETA: 16s
20992/59800 [=========>....................] - ETA: 16s
21248/59800 [=========>....................] - ETA: 15s
21504/59800 [=========>....................] - ETA: 15s
21760/59800 [=========>....................] - ETA: 15s
22016/59800 [==========>...................] - ETA: 15s
22272/59800 [==========>...................] - ETA: 15s
22400/59800 [==========>...................] - ETA: 15s
22656/59800 [==========>...................] - ETA: 15s
22912/59800 [==========>...................] - ETA: 15s
23040/59800 [==========>...................] - ETA: 14s
23168/59800 [==========>...................] - ETA: 14s
23424/59800 [==========>...................] - ETA: 14s
23680/59800 [==========>...................] - ETA: 14s
23936/59800 [===========>..................] - ETA: 14s
24192/59800 [===========>..................] - ETA: 14s
24448/59800 [===========>..................] - ETA: 14s
24704/59800 [===========>..................] - ETA: 14s
24960/59800 [===========>..................] - ETA: 13s
25216/59800 [===========>..................] - ETA: 13s
25472/59800 [===========>..................] - ETA: 13s
25728/59800 [===========>..................] - ETA: 13s
25984/59800 [============>.................] - ETA: 13s
26240/59800 [============>.................] - ETA: 13s
26496/59800 [============>.................] - ETA: 13s
26752/59800 [============>.................] - ETA: 12s
27008/59800 [============>.................] - ETA: 12s
27264/59800 [============>.................] - ETA: 12s
27520/59800 [============>.................] - ETA: 12s
27776/59800 [============>.................] - ETA: 12s
28032/59800 [=============>................] - ETA: 12s
28288/59800 [=============>................] - ETA: 12s
28544/59800 [=============>................] - ETA: 12s
28800/59800 [=============>................] - ETA: 11s
29056/59800 [=============>................] - ETA: 11s
29312/59800 [=============>................] - ETA: 11s
29568/59800 [=============>................] - ETA: 11s
29824/59800 [=============>................] - ETA: 11s
29952/59800 [==============>...............] - ETA: 11s
30208/59800 [==============>...............] - ETA: 11s
30464/59800 [==============>...............] - ETA: 11s
30720/59800 [==============>...............] - ETA: 11s
30976/59800 [==============>...............] - ETA: 10s
31232/59800 [==============>...............] - ETA: 10s
31488/59800 [==============>...............] - ETA: 10s
31744/59800 [==============>...............] - ETA: 10s
31872/59800 [==============>...............] - ETA: 10s
32128/59800 [===============>..............] - ETA: 10s
32384/59800 [===============>..............] - ETA: 10s
32640/59800 [===============>..............] - ETA: 10s
32896/59800 [===============>..............] - ETA: 10s
33152/59800 [===============>..............] - ETA: 10s
33408/59800 [===============>..............] - ETA: 9s 
33536/59800 [===============>..............] - ETA: 10s
33792/59800 [===============>..............] - ETA: 9s 
34048/59800 [================>.............] - ETA: 9s
34304/59800 [================>.............] - ETA: 9s
34560/59800 [================>.............] - ETA: 9s
34816/59800 [================>.............] - ETA: 9s
34944/59800 [================>.............] - ETA: 9s
35200/59800 [================>.............] - ETA: 9s
35456/59800 [================>.............] - ETA: 9s
35712/59800 [================>.............] - ETA: 9s
35968/59800 [=================>............] - ETA: 8s
36224/59800 [=================>............] - ETA: 8s
36480/59800 [=================>............] - ETA: 8s
36736/59800 [=================>............] - ETA: 8s
36992/59800 [=================>............] - ETA: 8s
37248/59800 [=================>............] - ETA: 8s
37504/59800 [=================>............] - ETA: 8s
37760/59800 [=================>............] - ETA: 8s
38016/59800 [==================>...........] - ETA: 8s
38272/59800 [==================>...........] - ETA: 7s
38528/59800 [==================>...........] - ETA: 7s
38784/59800 [==================>...........] - ETA: 7s
39040/59800 [==================>...........] - ETA: 7s
39296/59800 [==================>...........] - ETA: 7s
39552/59800 [==================>...........] - ETA: 7s
39680/59800 [==================>...........] - ETA: 7s
39936/59800 [===================>..........] - ETA: 7s
40192/59800 [===================>..........] - ETA: 7s
40448/59800 [===================>..........] - ETA: 7s
40576/59800 [===================>..........] - ETA: 7s
40832/59800 [===================>..........] - ETA: 7s
40960/59800 [===================>..........] - ETA: 6s
41088/59800 [===================>..........] - ETA: 6s
41344/59800 [===================>..........] - ETA: 6s
41600/59800 [===================>..........] - ETA: 6s
41856/59800 [===================>..........] - ETA: 6s
42112/59800 [====================>.........] - ETA: 6s
42240/59800 [====================>.........] - ETA: 6s
42496/59800 [====================>.........] - ETA: 6s
42752/59800 [====================>.........] - ETA: 6s
43008/59800 [====================>.........] - ETA: 6s
43136/59800 [====================>.........] - ETA: 6s
43392/59800 [====================>.........] - ETA: 6s
43648/59800 [====================>.........] - ETA: 6s
43776/59800 [====================>.........] - ETA: 6s
44032/59800 [=====================>........] - ETA: 5s
44288/59800 [=====================>........] - ETA: 5s
44544/59800 [=====================>........] - ETA: 5s
44800/59800 [=====================>........] - ETA: 5s
45056/59800 [=====================>........] - ETA: 5s
45312/59800 [=====================>........] - ETA: 5s
45568/59800 [=====================>........] - ETA: 5s
45824/59800 [=====================>........] - ETA: 5s
46080/59800 [======================>.......] - ETA: 5s
46336/59800 [======================>.......] - ETA: 5s
46592/59800 [======================>.......] - ETA: 4s
46848/59800 [======================>.......] - ETA: 4s
47104/59800 [======================>.......] - ETA: 4s
47360/59800 [======================>.......] - ETA: 4s
47616/59800 [======================>.......] - ETA: 4s
47872/59800 [=======================>......] - ETA: 4s
48000/59800 [=======================>......] - ETA: 4s
48256/59800 [=======================>......] - ETA: 4s
48512/59800 [=======================>......] - ETA: 4s
48768/59800 [=======================>......] - ETA: 4s
49024/59800 [=======================>......] - ETA: 4s
49280/59800 [=======================>......] - ETA: 3s
49408/59800 [=======================>......] - ETA: 3s
49664/59800 [=======================>......] - ETA: 3s
49792/59800 [=======================>......] - ETA: 3s
50048/59800 [========================>.....] - ETA: 3s
50304/59800 [========================>.....] - ETA: 3s
50560/59800 [========================>.....] - ETA: 3s
50816/59800 [========================>.....] - ETA: 3s
51072/59800 [========================>.....] - ETA: 3s
51200/59800 [========================>.....] - ETA: 3s
51456/59800 [========================>.....] - ETA: 3s
51712/59800 [========================>.....] - ETA: 3s
51968/59800 [=========================>....] - ETA: 2s
52224/59800 [=========================>....] - ETA: 2s
52480/59800 [=========================>....] - ETA: 2s
52736/59800 [=========================>....] - ETA: 2s
52992/59800 [=========================>....] - ETA: 2s
53248/59800 [=========================>....] - ETA: 2s
53504/59800 [=========================>....] - ETA: 2s
53632/59800 [=========================>....] - ETA: 2s
53888/59800 [==========================>...] - ETA: 2s
54144/59800 [==========================>...] - ETA: 2s
54400/59800 [==========================>...] - ETA: 2s
54656/59800 [==========================>...] - ETA: 1s
54912/59800 [==========================>...] - ETA: 1s
55040/59800 [==========================>...] - ETA: 1s
55296/59800 [==========================>...] - ETA: 1s
55552/59800 [==========================>...] - ETA: 1s
55808/59800 [==========================>...] - ETA: 1s
56064/59800 [===========================>..] - ETA: 1s
56320/59800 [===========================>..] - ETA: 1s
56576/59800 [===========================>..] - ETA: 1s
56832/59800 [===========================>..] - ETA: 1s
57088/59800 [===========================>..] - ETA: 1s
57344/59800 [===========================>..] - ETA: 0s
57600/59800 [===========================>..] - ETA: 0s
57856/59800 [============================>.] - ETA: 0s
58112/59800 [============================>.] - ETA: 0s
58368/59800 [============================>.] - ETA: 0s
58624/59800 [============================>.] - ETA: 0s
58880/59800 [============================>.] - ETA: 0s
59136/59800 [============================>.] - ETA: 0s
59392/59800 [============================>.] - ETA: 0s
59648/59800 [============================>.] - ETA: 0s
59800/59800 [==============================] - 22s 373us/step
write into: /usr/local/extstore01/gengyi/VisualSearch/msrvtt10ktest/results/msrvtt10ktrain/model_best.pth.tar/pred_errors_matrix.pth.tar
Running MSRVTT
 * Text to Video:
 * r_1_5_10, medr, meanr: [7.7, 22.3, 31.8, 33.0, 206.8]
 * recall sum: 61.8
 * mAP: 0.155
 * ----------
 * Video to text:
 * r_1_5_10, medr, meanr: [13.0, 30.3, 42.3, 16.0, 123.3]
 * recall sum: 85.6
 * mAP: 0.065
 * ----------
